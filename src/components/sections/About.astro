---
import { useTranslations } from '@i18n/utils';
import type { Locale } from '@i18n/constants';

interface Props {
  locale?: Locale;
}

const { locale = 'en' } = Astro.props;
const t = useTranslations(locale);

// Build the second paragraph with inline links
const linksSeparator = locale === 'es' ? ', ' : ', ';
const lastSeparator = locale === 'es' ? ' y ' : ', and ';
---

<section id="about" data-sr>
  <h2 class="numbered-heading">{t.about.heading}</h2>
  <div class="about-grid">
    <div class="about-text">
      <p set:html={t.about.paragraphs[0]} />
      <p>
        {t.about.paragraphs[1].split('{links}')[0]}
        {t.about.companyLinks.map((link, i) => (
          <>
            <a class="inline-link" href={link.url} target="_blank" rel="noreferrer">{link.text}</a>{i < t.about.companyLinks.length - 2 ? linksSeparator : i === t.about.companyLinks.length - 2 ? lastSeparator : ''}
          </>
        ))}
        {t.about.paragraphs[1].split('{links}')[1]}
      </p>
      <p>{t.about.skillsIntro}</p>
      <ul class="skills-list fancy-list">
        {t.about.skills.map(skill => (
          <li>{skill}</li>
        ))}
      </ul>
    </div>
    <div class="about-image">
      <div class="image-wrapper">
        <div class="image-inner">
          <img src={t.about.imageUrl} alt={t.about.imageAlt} width="500" height="500" />
        </div>
      </div>
    </div>
  </div>
</section>

<style>
  section {
    max-width: 900px;
  }

  .about-grid {
    display: grid;
    grid-template-columns: 3fr 2fr;
    gap: 50px;
  }

  @media (max-width: 768px) {
    .about-grid {
      display: block;
    }
  }

  .about-text p {
    margin-bottom: 15px;
  }

  .skills-list {
    display: grid;
    grid-template-columns: repeat(2, minmax(140px, 200px));
    gap: 0 10px;
    padding: 0;
    margin: 20px 0 0;
    overflow: hidden;
    list-style: none;
  }

  .skills-list li {
    font-family: var(--font-mono);
    font-size: var(--fz-xs);
  }

  .about-image {
    position: relative;
    max-width: 300px;
  }

  @media (max-width: 768px) {
    .about-image {
      margin: 50px auto 0;
      width: 70%;
    }
  }

  .image-wrapper {
    display: block;
    position: relative;
    width: 100%;
    border-radius: var(--border-radius);
    transition: var(--transition);
  }

  .image-wrapper::after {
    content: '';
    display: block;
    position: absolute;
    width: 100%;
    height: 100%;
    border-radius: var(--border-radius);
    border: 2px solid var(--flutter-blue);
    top: 14px;
    left: 14px;
    z-index: -1;
    transition: var(--transition);
  }

  .image-wrapper:hover::after {
    top: 10px;
    left: 10px;
  }

  .image-wrapper:hover {
    transform: translate(-4px, -4px);
  }

  .image-inner {
    position: relative;
    border-radius: var(--border-radius);
    overflow: hidden;
  }

  .image-inner::before {
    content: '';
    position: absolute;
    inset: 0;
    background-color: var(--flutter-blue);
    mix-blend-mode: screen;
    z-index: 1;
    transition: var(--transition);
  }

  .image-wrapper:hover .image-inner::before {
    background-color: transparent;
  }

  .image-inner img {
    display: block;
    width: 100%;
    height: auto;
    border-radius: var(--border-radius);
    filter: grayscale(100%) contrast(1);
    transition: var(--transition);
  }

  .image-wrapper:hover .image-inner img {
    filter: none;
  }
</style>
